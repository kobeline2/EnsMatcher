# EnsMatcher

æœ¬ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã€ãƒ‡ãƒ¼ã‚¿ X, Y, Z ã‚’ç”¨ã„ãŸå‡¦ç†ãƒ»æ¤œè¨¼ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚’æ§‹æˆã—ã¦ã„ã¾ã™ã€‚å‡¦ç†ã¯ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã”ã¨ã«åˆ†é›¢ã•ã‚Œã¦ãŠã‚Šã€å„å‡¦ç†ã¯å€‹åˆ¥ã® YAML è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½¿ã£ã¦åˆ¶å¾¡ã•ã‚Œã¾ã™ã€‚

## ğŸ“ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ
<pre>
   MyApp/
   â”œâ”€â”€ config/    
   â”‚   â”œâ”€â”€ preprocess.yaml         # æº–å‚™ãƒ‡ãƒ¼ã‚¿ä½œæˆ
   â”‚   â”œâ”€â”€ compute.yaml            # ãƒãƒƒãƒãƒ³ã‚°
   â”‚   â””â”€â”€ evaluate.yaml           # è©•ä¾¡è¨­å®š
   â”‚
   â”œâ”€â”€ data/             
   â”‚   â”œâ”€â”€ d4pdf/                  # D4PDF
   â”‚   â”œâ”€â”€ ens/                    # ensemble 
   â”‚   â””â”€â”€ amedas/                 # amedas
   â”‚
   â”œâ”€â”€ preprocessed/     
   â”‚   â””â”€â”€ X_prime/
   â”‚
   â”œâ”€â”€ res/              
   â”‚   â”œâ”€â”€ W_values/           # Wã®å‡ºåŠ›
   â”‚   â””â”€â”€ evaluation/         # Wã¨Zã®æ¯”è¼ƒçµæœ
   â”‚
   â”œâ”€â”€ src/         
   â”‚   â”œâ”€â”€ preprocessing/      # Xã®å‰å‡¦ç†é–¢æ•°ç¾¤
   â”‚   â”œâ”€â”€ computeW/           # Wã®è¨ˆç®—é–¢é€£ã‚³ãƒ¼ãƒ‰
   â”‚   â””â”€â”€ evaluation/         # è©•ä¾¡å‡¦ç†ï¼ˆZã¨ã®æ¯”è¼ƒãªã©ï¼‰
   â”‚
   â”œâ”€â”€ scripts/          
   â”‚   â”œâ”€â”€ run_preprocess.m
   â”‚   â”œâ”€â”€ run_compute.m
   â”‚   â””â”€â”€ run_evaluate.m
   â”‚
   â”œâ”€â”€ utils/            
   â”‚
   â””â”€â”€ README.md         
</pre>



## é–¢æ•°ã®èª¬æ˜
d4pdf_rainMatrix: 


## âš™ï¸ å‡¦ç†ã®æµã‚Œ
### å‰å‡¦ç†
1. QGISã‹ã‚‰æ‰‹å‹•ã§æµåŸŸã‚’æŠ½å‡º
1. pythonã§d4pdfã‹ã‚‰æµåŸŸã‚’åˆ‡ã‚Šå‡ºã™ãŸã‚ã®d4pdfæ¸¬ç‚¹ã«å¯¾ã™ã‚‹ãƒ†ã‚£ãƒ¼ã‚»ãƒ³åˆ†å‰²ã‚’ãŠã“ãªã†
   src/python/src/d4pdf2voronoi.py + config
1. d4pdfã‹ã‚‰æµåŸŸã‚’åˆ‡ã‚Šå‡ºã—ã¦, æŒ‡å®šã—ãŸæµåŸŸã®å¹´Nä½ã¾ã§ã®Mæ™‚é–“é›¨é‡ã‚’æŠ½å‡º â†’ output dat(ãƒ•ã‚¡ã‚¤ãƒ«æ•°ã¯NÃ—732, æ¸¬ç‚¹æ•°Ã—Mè¡Œåˆ—)
   src/basin_extraction/d4pdf/d4pdf_rainMatrix.m
1. pythonã§ensã‹ã‚‰æµåŸŸã‚’åˆ‡ã‚Šå‡ºã™ãŸã‚ã®ensæ¸¬ç‚¹ã«å¯¾ã™ã‚‹ãƒ†ã‚£ãƒ¼ã‚»ãƒ³åˆ†å‰²ã‚’ãŠã“ãªã†
   src/python/src/ensemble2voronoi.py
1. ensã‹ã‚‰æµåŸŸã‚’åˆ‡ã‚Šå‡ºã—ã¦, é›¨ã‚’åˆ‡ã‚Šå‡ºã™ â†’ output dat (ãƒ•ã‚¡ã‚¤ãƒ«æ•°ã¯25ï¼ˆ(15-3)/0.5æ—¥+1ï¼‰ã®åˆæœŸæ™‚åˆ»Ã—51, æ¸¬ç‚¹æ•°Ã—Mè¡Œåˆ—)
   src/basin_extraction/ensemble/ensemble_rainMatrix.m
1. pythonã§amedasã‹ã‚‰æµåŸŸã‚’åˆ‡ã‚Šå‡ºã™ãŸã‚ã®amedasæ¸¬ç‚¹ã«å¯¾ã™ã‚‹ãƒ†ã‚£ãƒ¼ã‚»ãƒ³åˆ†å‰²ã‚’ãŠã“ãªã†
   src/python/src/kaiseki2voronoi.py
1. kaisekiã‹ã‚‰æµåŸŸã‚’åˆ‡ã‚Šå‡ºã—ã¦, é›¨ã‚’åˆ‡ã‚Šå‡ºã™ â†’ output dat (ãƒ•ã‚¡ã‚¤ãƒ«æ•°ã¯1, æ¸¬ç‚¹æ•°Ã—Mè¡Œåˆ—)
   src/basin_extraction/kaiseki/kaiseki_rainMatrix.m
      ã“ã“ã§, è§£æã®ãƒªã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã‚‚è¡Œã†

### ã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°
1. d4pdfã®ã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°
   src/matching/clustering_both.m â†’ output å‹•ç”»ã¨matãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‡ºåŠ›ï¼ˆã‚¯ãƒ©ã‚¹ã‚¿æ•°Ã—ï¼ˆæ¸¬ç‚¹æ•°Ã—Mæ™‚é–“ï¼‰è¡Œåˆ—ï¼‰
### ãƒãƒƒãƒãƒ³ã‚°
1. d4pdfã¨Ensã¨ã®ãƒãƒƒãƒãƒ³ã‚°ï¼ˆã“ã“ã§è§£æé›¨é‡ã‚‚ãƒãƒƒãƒãƒ³ã‚°ã™ã‚‹ï¼‰
   src/matching/matching_both.m â†’ output ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ— & çš„ä¸­ç‡ã‚’è¨ˆç®—ã™ã‚‹ãŸã‚ã®æƒ…å ±
      ã“ã“ã§, ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«ã®ãƒªã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã‚‚è¡Œã†
### æ¤œè¨¼
1. çš„ä¸­ç‡ã‚’è¨ˆç®—
   













## âš™ï¸ å‡¦ç†ã®æµã‚Œ

1. **å‰å‡¦ç†ï¼ˆX â†’ X'ï¼‰**
   - `scripts/run_preprocess.m` ã‚’å®Ÿè¡Œ
   - è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«: `config/preprocess.yaml`
   - å‡ºåŠ›å…ˆ: `preprocessed/X_prime/`

2. **è¨ˆç®—ï¼ˆX', Y â†’ Wï¼‰**
   - `scripts/run_compute.m` ã‚’å®Ÿè¡Œ
   - è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«: `config/compute.yaml`
   - å‡ºåŠ›å…ˆ: `results/W_values/`

3. **è©•ä¾¡ï¼ˆW, Z â†’ ç²¾åº¦æŒ‡æ¨™ï¼‰**
   - `scripts/run_evaluate.m` ã‚’å®Ÿè¡Œ
   - è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«: `config/evaluate.yaml`
   - å‡ºåŠ›å…ˆ: `results/evaluation/`

## ğŸ“ YAMLè¨­å®šã«ã¤ã„ã¦

å„ `.yaml` ãƒ•ã‚¡ã‚¤ãƒ«ã§ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªæƒ…å ±ã‚’æŒ‡å®šã—ã¾ã™ï¼š

```yaml
# ä¾‹: preprocess.yaml
input: data/X/raw.csv
output: preprocessed/X_prime/processed.csv
method: standardize
params:
  window_size: 10
